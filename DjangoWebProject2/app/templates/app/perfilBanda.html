{% extends "app/layout.html" %}

{% block sidebar %}
    {% if tipoUsuario == 1  %}
        {% include "app/sidebarartistapartial.html" %}
    {% elif tipoUsuario == 2 %}
        {% include "app/sidebarnormalpartial.html" %}
    {% endif%}
{% endblock %}
{% block content %}

<div class="container sfull" id-banda="{{ banda.id }}">
<div class="row" >
    
    <div class="col s12">
        <div class="card white">
            <div class="foto-portada" style="background:url({{banda.imagenPortada.url}});" >
            </div>
            <div class="container center-align">
                <div class="row">
                    <div class="col s12 ">
                        <div class="inline blue z-depth-1"><img src="{{banda.imagenPerfil.url}}" alt="" 
                style="width:100px;height:100px;border:solid 1px #444;margin-top:-50px;"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 ">
                        {%if esLider%}
                        <h5 class="campo-editable center-align"> 
                            <form method="POST" data-target="nombre" largomaximo="20" class="inline" style="width:450px">
                                {% csrf_token %}
                                <span class="no-hide dato">{{banda.nombre}}</span> 
                                <input class="w60p hide"  type="text" name="dato" value="{{banda.nombre}}" />
                                <a class="btn no-hide editar toggle color-principal hover-shadow">
                                    <i class="material-icons">&#xE254;</i>
                                </a> 
                                <a class="btn hide editar submit green hover-shadow tooltipped" data-tooltip="Guardar cambios">
                                    <i class="material-icons">&#xE5CA;</i>
                                </a>
                            </form>
                        {%else%}
                        <h5>{{banda.nombre}}
                        {%endif%}
                        </h5>
                        <h6>{{ banda.genero.nombre }}</h6>
                    </div>
                </div>
                <div class="row">
                    <div class="col l6 s12 ">
                        <div class="container sfull">
                            <div class="row">   
                                <div class="col s12 left-align card-panel grey lighten-4" style="padding:15px 10px"><span >{{banda.biografia}}</span></div>
                            </div>
                            <div class="row">
                                <div class="col offset-s2 s8 card-panel color-principal" style="padding:15px"><b> {{ seguidores }} Seguidor{%if seguidores != 1%}es{% endif%}</b></div>
                            </div>
                            <div class="row">
                                <div class="col s12 grade-container" data-grade="4"  >
                                    
                                    {#caracteristica no implementada debido a que esmanejada por usuarios normales#}
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade grey-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                </div>
                            </div>

                            

                            {# hay que quitar esta wea de if al pasarlo pa la wea de la otra wea #}
                            {%if discos|length > 0  %}
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Discografia</h5>
                                    <ul class="collection">
                                        {% for disco in discos %}
                                        <li class="collection-item disco valign-wrapper manito"  data-dId="{{disco.id}}">
                                            <i class="material-icons orange darken-3 white-text" style="padding:3px;font-size:40px">&#xE019;</i>
                                            <span class="truncate" style="margin-left:20px;width:calc(100% - 50px);">{{disco.nombre}}</span>
                                            <span class="secondary-content stext cyan-text text-darken-4">{{disco.lanzamiento.year}}</span>
                                        </li>
                                        {% endfor %}

                                      </ul>
                                </div>
                            </div>
                            {%endif%}
                            {%if solicitantes|length > 0  %}
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Solicitantes</h5>
                                    <ul class="collection">
                                        {% for solicitud in solicitantes %}
                                        <li class="collection-item valign-wrapper" >
                                          <form method="POST" data-target="aceptarSolicitud" >
                                            {% csrf_token %}

                                            <a class="valign-wrapper" href="/perfilArtistaNp/{{solicitud.artista.id}}">
                                            <div class="circle avatar-perfil small" style="background: url({{solicitud.artista.imagenPerfil.url}}); " ></div>
                                            <div class="" style="margin-left:20px;"><span >{{solicitud.artista.nombre}}</span>
                                            </a>
                                            <br>
                                            <input name ="dato" hidden="true" value="{{ solicitud.id }}"></input>
                                            <input id="accion" name ="olddato" hidden="true" value="aceptar"></input>
                                            <button class="submit editar btn green" onclick="document.getElementById('accion').setAttribute('value', 'aceptar')" ><i class="material-icons">&#xE5CA;</i></button>
                                            <button class="submit editar btn red" onclick="document.getElementById('accion').setAttribute('value', 'rechazar')"   ><i class="material-icons">&#xE14C;</i></button>
                                            </div>
                                        </form>
                                        </li>
                                        {% endfor %}
                                      </ul>
                                </div>
                            </div>
                            {%endif%}
                        </div>
                    </div>
                    <div class="col l6 s12 ">
                        <div class="container">
                            <div class="row">
                                <div class="col s12 ">
                                    <a class="twitter-timeline" href="https://twitter.com/Crunchyroll" data-widget-id="634820916141289472" data-screen-name="{{banda.cuentaTwitter}}"></a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Integrantes</h5>

                                    <div id="integrante" class="collection">
                                        {% for integrante in integrantes %}
                                        <li class="collection-item valign-wrapper">
                                            <a class="valign-wrapper" href="/perfilArtistaNp/{{integrante.integrante.id}}">
                                                <div class="circle avatar-perfil small" style="background: url({{integrante.integrante.imagenPerfil.url}}); " ></div>
                                                <div class="" style="margin-left:20px;"><span >{{integrante.integrante.nombre}}</span>
                                                <br><span class="grey-text ">{{integrante.ocupacion}}</span></div>
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                           
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Material</h5> 
                                    <ul class="collection materiales">
                                    {%if material|length > 0%}
                                    {% for m in material %}
                                        <li id="mat{{m.id}}" class=" collection-item manito">
                                            <span class="right white red-text text-darken-2 valign-wrapper tooltipped" data-position="right" data-tooltip="quitar material" style="height:46px" onclick="removeMaterial({{m.id}})"><i class="material-icons">remove_circle</i></span>
                                            <a class="valign-wrapper tooltipped" href="{{m.enlace}}" data-tooltip="ir al enlace" target="_blank">
                                                <div class="inline" style="margin:0"><i class="material-icons {{m.color}} white-text " style="padding:8px;">{{m.tipo}}</i></div>
                                                <div class="inline">{{m.nombre|title}}<br><span class="truncate grey-text stext">{{m.descripcion}}</span></div>

                                            </a>
                                            
                                        </li>
                                    {% endfor %}
                                    {%else%}
                                        <li class="collection-item valign-wrapper no-hay-material no-select pointer">
                                                <div class="inline" style="margin:0"><i class="material-icons grey lighten-1 white-text " style="padding:8px;">link</i></div>
                                                <div class="inline grey-text text-darken-2">No hay Material<br><span class="truncate grey-text stext">La banda aún no adjunta material</span></div>
                                                {#<span class="secondary-content">{algo pondré}</span>#}
                                            
                                        </li>
                                    {%endif%}
                                        <li class="add-material collection-item valign-wrapper manito hover-grey no-select modal-trigger" href="#modalMaterial">
                                                <div class="inline" style="margin:0"><i class="material-icons blue darken-2 white-text " style="padding:8px;">&#xE2C6;</i></div>
                                                <div class="inline grey-text text-darken-3">Agregar material<br><span class="truncate grey-text stext text-darken-1">Adjunta material para que todos puedan verla</span></div>
                                        </li>
                                    </ul>
                                    

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</div>
</div>


<!-- Modal Structure -->
<div id="modalMaterial" class="modal ">
    <div class="modal-content">
        <h4>Agregar material</h4>
        
        <div class="divider"></div>
        <form id="addMaterial" method="POST" action="/agregarMaterial" data-target="nombre">
            {% csrf_token %}
            <h5 class="grey-text">Opciones del cuadro</h5>
            <div>
                
                <label>Icono</label>
                <ul class="select inline">
                    <li class="cabezaSelect"><i class="material-icons">remove</i></li>
                </ul>
                <input class="inIcon" name="icon"  type="hidden" /> 
                <div class="selector" >
                    <div>
                        <ul>
                            <li><i class="material-icons">explore</i></li>
                            <li><i class="material-icons">play_arrow</i></li>
                            <li><i class="material-icons">announcement</i></li>
                            <li><i class="material-icons">book</i></li>
                            <li><i class="material-icons">description</i> </li>
                            <li><i class="material-icons">favorite</i> </li>
                            <li><i class="material-icons">input</i> </li>
                            <li><i class="material-icons">info</i> </li>
                            <li><i class="material-icons">label</i> </li>
                            <li><i class="material-icons">language</i> </li>
                            <li><i class="material-icons">room</i> </li>
                            <li><i class="material-icons">receipt</i> </li>
                            <li><i class="material-icons">shop</i> </li>
                            <li><i class="material-icons">visibility</i> </li>
                            <li><i class="material-icons">work</i> </li>
                            <li><i class="material-icons">equalizer</i> </li>
                            <li><i class="material-icons">library_music</i> </li>
                            <li><i class="material-icons">mic</i> </li>
                            <li><i class="material-icons">movie</i> </li>
                            <li><i class="material-icons">new_releases</i> </li>
                            <li><i class="material-icons">radio</i> </li>
                            <li><i class="material-icons">volume_up</i> </li>
                            <li><i class="material-icons">web</i> </li>
                            <li><i class="material-icons">drafts</i> </li>
                            <li><i class="material-icons">link</i> </li>
                            <li><i class="material-icons">devices</i> </li>
                            <li><i class="material-icons">usb</i> </li>
                            <li><i class="material-icons">widgets</i> </li>
                            <li><i class="material-icons">attach_file</i> </li>
                            <li><i class="material-icons">insert_drive_file</i> </li>
                            <li><i class="material-icons">cloud_circle</i> </li>
                            <li><i class="material-icons">gamepad</i> </li>
                            <li><i class="material-icons">camera_alt</i> </li>
                        </ul>
                    </div>
                </div>
                <div class="color-selector inline">
                    <input type="hidden" name="color">
                    <div class="piker z-depth-1 hide">
                        <a class="color red" data-option="red" ></a>
                        <a class="color blue darken-2" data-option="blue darken-2" ></a>
                        <a class="color green darken-2" data-option="green darken-2" ></a>
                        <a class="color orange darken-2" data-option="orange darken-2" ></a>
                        <a class="color yellow darken-3" data-option="yellow darken-3" ></a>
                        <a class="color pink darken-4" data-option="pink darken-4" ></a>
                        <a class="color purple darken-4" data-option="purple darken-4" ></a>
                        <a class="color cyan accent-4" data-option="cyan accent-4" ></a>
                        <a class="color brown darken-4" data-option="brown darken-4" ></a>
                    </div>
                    <label>color</label>
                    <ul class="trigger white-text inline">
                        <li><i class="material-icons">palette</i></li>
                    </ul>
                    
                </div>
                <div class="input-field col l6 s12" style="max-width:450px" >
                    <input class="validate" type="text" id="nombre" name='nombre' maxlength="30" required>
                    <label for="descripcion">Nombre</label>
                </div>
            </div>
            <div class="container" style="margin-left:-30px"><div class="row">
                <div class="input-field  col l6 s12" >
                    <i class="material-icons prefix">link</i>
                    <input class="validate" type="text" id="enlace" style="max-width:450px" name='enlace' required>
                    <label for="enlace">Enlace</label>
                </div>
                
                <div class="input-field col l6 s12" >
                    <i class="material-icons prefix">format_quote</i>
                    <input class="validate" type="text" id="descripcion" style="max-width:450px" name='desc' maxlength="60" required>
                    <label for="descripcion">Descripción</label>
                </div>
            </div></div>
        </form>
    </div>
    <div class="modal-footer">
      <a class=" modal-action waves-effect waves-green btn-flat" onclick="$('#addMaterial').submit();"  >Aceptar</a>
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" >Cancelar</a>
    </div>
  </div>
  <div id="modalDisco" class="modal modal-fixed-footer"">
    <div class="modal-content" style="background:url( '/media/app/static/app/images/discbg.jpg');background-size:100%;;height: 100%;">
        
    </div>
    <div class="modal-footer color-principal" >
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" onclick="$('#modalDisco').closeModal();"  >Salir</a>
    </div>
  </div>


{% endblock %}
{% block scripts %}

{% load staticfiles %}

<script type="text/javascript">$('.modal-trigger').leanModal();</script>
<script type="text/javascript">
    $(document).ready(function(){
      //fin color selector
    $('select').material_select();
    //{# solo para no lider #}
    $('.disco').click(function(){
       console.log("disco id:"+$(this).attr('data-dId'));
       $('#modalDisco').openModal();
       var modal = $('#modalDisco .modal-content')
       $.get("/infoDisco/"+$(this).attr('data-dId'),function(data){
            modal.html("")
            modal.html(data)
       }).fail(function() {
            console.error( "error" );
       });
       });
    });
</script>
    <script type="text/javascript">
    $(document).ready(function(){
        $(document).ajaxSend(function (event, jqxhr, settings) {
            jqxhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
        });
    });
    </script>
    <script src="{% static 'app/scripts/editarbandaint.js' %}"></script>
    {#<script src="{% static 'app/scripts/solicitudes.js' %}"></script>#}
{% endblock %}