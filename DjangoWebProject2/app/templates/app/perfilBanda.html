{% extends "app/layout.html" %}

{% block sidebar %}
    {% if tipoUsuario == 1  %}
        {% include "app/sidebarartistapartial.html" %}
    {% elif tipoUsuario == 2 %}
        {% include "app/sidebarnormalpartial.html" %}
    {% endif%}
{% endblock %}
{% block content %}

<div class="container sfull" id-banda="{{ idBanda }}">
<div class="row" >
    
    <div class="col s12">
        <div class="card white">
            <div class="foto-portada" style="background:url({{banda.imagenPortada.url}});" >
            </div>
            <div class="container center-align">
                <div class="row">
                    <div class="col s12 ">
                        <div class="inline blue z-depth-1"><img src="{{banda.imagenPerfil.url}}" alt="" 
                style="width:100px;height:100px;border:solid 1px #444;margin-top:-50px;"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 "><h5 >{{ banda.nombre }}<h6>{{ banda.genero.nombre }}</h6></h5></div>
                </div>
                <div class="row">
                    <div class="col l6 s12 ">
                        <div class="container sfull">
                            <div class="row">   
                                <div class="col s12 left-align card-panel grey lighten-4" style="padding:15px 10px"><span >{{banda.biografia}}</span></div>
                            </div>
                            <div class="row">
                                <div class="col offset-s2 s8 card-panel color-principal" style="padding:15px"><b> {{ seguidores }} Seguidor{%if seguidores != 1%}es{% endif%}</b></div>
                            </div>
                            <div class="row">
                                <div class="col s12 grade-container" data-grade="4"  >
                                    
                                    {#caracteristica no implementada debido a que esmanejada por usuarios normales#}
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade orange-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                    <i class="material-icons manito inline grade grey-text"  style="font-size:28px;margin:-3px;padding:3px;">grade</i>
                                </div>
                            </div>

                            

                            {# hay que quitar esta wea de if al pasarlo pa la wea de la otra wea #}
                            {%if discos|length > 0  %}
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Discografia</h5>
                                    <ul class="collection">
                                        {% for disco in discos %}
                                        <li class="collection-item disco valign-wrapper manito"  data-dId="{{disco.id}}">
                                            <i class="material-icons orange darken-3 white-text" style="padding:3px;font-size:40px">&#xE019;</i>
                                            <span class="truncate" style="margin-left:20px;width:calc(100% - 50px);">{{disco.nombre}}</span>
                                            <span class="secondary-content stext cyan-text text-darken-4">{{disco.lanzamiento.year}}</span>
                                        </li>
                                        {% endfor %}

                                      </ul>
                                </div>
                            </div>
                            {%endif%}
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Solicitantes</h5>
                                    <ul class="collection">
                                        {% for solicitud in solicitantes %}
                                        <li class="collection-item valign-wrapper" >
                                          <form method="POST" data-target="aceptarSolicitud" >
                                            {% csrf_token %}

                                            <a class="valign-wrapper" href="/perfilArtistaNp/{{solicitud.artista.id}}">
                                            <div class="circle avatar-perfil small" style="background: url({{solicitud.artista.imagenPerfil.url}}); " ></div>
                                            <div class="" style="margin-left:20px;"><span >{{solicitud.artista.nombre}}</span>
                                            </a>
                                            <br>
                                            <input name ="dato" hidden="true" value="{{ solicitud.id }}"></input>
                                            <input id="accion" name ="olddato" hidden="true" value="aceptar"></input>
                                            <button class="submit editar btn green" onclick="document.getElementById('accion').setAttribute('value', 'aceptar')" ><i class="material-icons">&#xE5CA;</i></button>
                                            <button class="submit editar btn red" onclick="document.getElementById('accion').setAttribute('value', 'rechazar')"   ><i class="material-icons">&#xE14C;</i></button>
                                            </div>
                                        </form>
                                        </li>
                                        {% endfor %}
                                      </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col l6 s12 ">
                        <div class="container">
                            <div class="row">
                                <div class="col s12 ">
                                    <a class="twitter-timeline" href="https://twitter.com/Crunchyroll" data-widget-id="634820916141289472" data-screen-name="{{banda.cuentaTwitter}}"></a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Integrantes</h5>

                                    <div id="integrante" class="collection">
                                        {% for integrante in integrantes %}
                                        <li class="collection-item valign-wrapper">
                                            <a class="valign-wrapper" href="/perfilArtistaNp/{{integrante.integrante.id}}">
                                                <div class="circle avatar-perfil small" style="background: url({{integrante.integrante.imagenPerfil.url}}); " ></div>
                                                <div class="" style="margin-left:20px;"><span >{{integrante.integrante.nombre}}</span>
                                                <br><span class="grey-text ">{{integrante.ocupacion}}</span></div>
                                            </a>
                                        </li>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                           
                            <div class="row">
                                <div class="col s12 left-align">
                                    <h5>Material</h5> 
                                    <ul class="collection">
                                    {%if material|length > 0%}
                                    {% for m in material %}
                                        <li class="collection-item manito">

                                            <a class="valign-wrapper tooltipped" href="{{m.enlace}}" data-tooltip="ir al enlace" target="_blank">
                                                <div class="inline" style="margin:0"><i class="material-icons red white-text " style="padding:8px;">{{m.tipo}}</i></div>
                                                <div class="inline">{{m.nombre|title}}<br><span class="truncate grey-text stext">{{m.descripcion}}</span></div>
                                                {#<span class="secondary-content">{algo pondré}</span>#}
                                            </a>

                                        </li>
                                    {% endfor %}
                                    {%else%}
                                        <li class="collection-item valign-wrapper no-select pointer">
                                                <div class="inline" style="margin:0"><i class="material-icons grey lighten-1 white-text " style="padding:8px;">link</i></div>
                                                <div class="inline grey-text text-darken-2">No hay Material<br><span class="truncate grey-text stext">La banda aún no adjunta material</span></div>
                                                {#<span class="secondary-content">{algo pondré}</span>#}
                                            
                                        </li>
                                    {%endif%}
                                        <li class="collection-item valign-wrapper manito hover-grey no-select modal-trigger" href="#modalMaterial">
                                                <div class="inline" style="margin:0"><i class="material-icons blue darken-2 white-text " style="padding:8px;">&#xE2C6;</i></div>
                                                <div class="inline grey-text text-darken-3">Agregar material<br><span class="truncate grey-text stext text-darken-1">Adjunta material para que todos puedan verla</span></div>
                                        </li>
                                    </ul>
                                    

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</div>
</div>


<!-- Modal Structure -->
<div id="modalMaterial" class="modal ">
    <div class="modal-content">
        <h4>Agregar material</h4>
        <label>Icono</label>
        <ul class="select inline">
            <li class="cabezaSelect"></li>
        </ul>
        <input class="inIcon" name="icon"  type="hidden" /> 
        <div class="selector" >
            <div>
                <ul>
                    <li><i class="material-icons">explore</i></li>
                    <li><i class="material-icons">announcement</i></li>
                    <li><i class="material-icons">book</i></li>
                    <li><i class="material-icons">description</i> </li>
                </ul>
            </div>
        </div>
        <div class="color-selector inline">
            <input type="hidden" name="color">
            <div class="piker z-depth-1">
                <a class="color red" data-option="red" ></a>
                <a class="color blue darken-2" data-option="blue darken-2" ></a>
                <a class="color green darken-2" data-option="green darken-2" ></a>
                <a class="color orange darken-2" data-option="orange darken-2" ></a>
                <a class="color yellow darken-3" data-option="yellow darken-3" ></a>
                <a class="color pink darken-4" data-option="pink darken-4" ></a>
                <a class="color purple darken-4" data-option="purple darken-4" ></a>
                <a class="color cyan accent-4" data-option="cyan accent-4" ></a>
                <a class="color brown darken-4" data-option="brown darken-4" ></a>
            </div>
            <div class="trigger white-text grey inline"><i class="material-icons">palette</i></div>
            <label>color</label>
        </div>
        
    </div>
    <div class="modal-footer">
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" onclick="$('#modalMaterial').closeModal();"  >Aceptar</a>
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" onclick="$('#modalMaterial').closeModal();"  >Cancelar</a>
    </div>
  </div>
  <div id="modalDisco" class="modal modal-fixed-footer">
    <div class="modal-content" style="background:url( '/media/app/static/app/images/discbg.jpg');background-size:100%">
        
    </div>
    <div class="modal-footer color-principal" >
      <a class=" modal-action modal-close waves-effect waves-green btn-flat" onclick="$('#modalDisco').closeModal();"  >Salir</a>
    </div>
  </div>


{% endblock %}
{% block scripts %}

{% load staticfiles %}

<script type="text/javascript">$('.modal-trigger').leanModal();</script>
<script type="text/javascript">
    $(document).ready(function(){
        $('#modalMaterial').openModal();
        $('.cabezaSelect').click(function(e) {
			var cabezaSelect=$(this);
           $('.selector').show();
			$('.selector li').click(function(e) {
              var clase=$(this).find('i').text();
				$(cabezaSelect).html('<i class=\"material-icons\">'+clase+'</i>')
				$('.inIcon').val(clase);
				$('.selector').hide();
           });
		   
        });
        
         $('select').material_select();
        //funcion para activar las estrellas
        $('.grade').mouseover(function(){
            var grade = $('.grade').index($(this));
            $('.grade').each(function (k,el){
                if(k<=grade){
                    if($(el).hasClass('grey-text')){
                        $(el).removeClass('grey-text')
                        $(el).addClass('orange-text')
                    }
                }else{
                    if($(el).hasClass('orange-text')){
                        $(el).removeClass('orange-text')
                        $(el).addClass('grey-text')
                    }
                }
            });
        });
        $('.grade').mouseout(function(){
            var grade= $('.grade-container').attr('data-grade');
            $('.grade').each(function (k,el){
                if(k<grade){
                    if($(el).hasClass('grey-text')){
                        $(el).removeClass('grey-text')
                        $(el).addClass('orange-text')
                    }
                }else{
                    if($(el).hasClass('orange-text')){
                        $(el).removeClass('orange-text')
                        $(el).addClass('grey-text')
                    }
                }
            });
        });
        $('.grade').click(function(){
            var grade = $('.grade').index(this)+1;
             $('.grade-container').attr('data-grade',grade);
        });
            
    });
    //{# solo para no lider #}
    $('.disco').click(function(){
       console.log("disco id:"+$(this).attr('data-dId'));
       $('#modalDisco').openModal();
       var modal = $('#modalDisco .modal-content')
       $.get("/infoDisco/"+$(this).attr('data-dId'),function(data){
            modal.html("")
            modal.html(data)
       }).fail(function() {
            console.error( "error" );
       })
    });
</script>
    <script type="text/javascript">
    $(document).ready(function(){
        $(document).ajaxSend(function (event, jqxhr, settings) {
            jqxhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
        });
    });
    </script>
    <script src="{% static 'app/scripts/solicitudes.js' %}"></script>
{% endblock %}